# 🔎 kubernetes efs driver install 
#  GitHub --> Example/kubernetes --> static-provisioning --> spec --> pv.yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: efs-static
spec:
  capacity:  # capacity lo storage anedi Dummy, Urike syntax kosam pettaru. Because it is Elastic, It will grow
    storage: 5Gi 
  volumeMode: Filesystem
  accessModes:  # You can change your wish ReadWritemany kuda. 
    - ReadWriteOnce
  storageClassName: " "  # This should be empty in static provisioning
  persistentVolumeReclaimPolicy: Retain
  csi:
    driver: efs.csi.aws.com
    volumeHandle:      # <--- Manam yedi ite create chesamo, adi tisukovali.
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: efs-static
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: " "  # This should be empty in static provisioning
  resources:
    requests:
      storage: 5Gi
---
apiVersion: v1
kind: Pod
metadata:
  name: nginx
  labels:
    purpose: efs-static-demo
    project: roboshop
spec:
  containers:
  - name: nginx
    image: nginx
    volumeMounts:   # docker run -v host-path:container-path
    - name: persistent-storage
      mountPath: /usr/share/nginx/html 
  volumes:
  - name: persistent-storage
    persistentVolumeClaim:
      claimName: efs-static  # < -- manam clear gha chepputunnam, ebs-static lo store chey ani (PVC) lo. Eee PVC velli PV lo store avutmdhi. it means EBS only. 

# Kubernetes ki yemi chepputunam, Nvu ee Pod ni create chetappudu ee labels ni, line no 40 ane label ni consider cheysi, andulopala preference vachhesi andhulopla ee pod ni create cheyamani. US-EAST-1C lo yevi ite nodes unnayyo, aa Nodes lopala ee Pod ni create cheyamani chepputunam. 

--- 
# Eppudu nenu nginx ni chudali ante, External world lo, what should i create, bhyata nimdi nginx ni access cheyali ante, i need to create a service, what type of service either Nodeport (or) Loadbalancer

# 🔍 kubernetes service
apiVersion: v1
kind: Service # yee rakamina resource vadutunnav, aa resources type
metadata:
  name: efs-static # aa Resources type ki oka peru 
  labels:
    purpose: efs-static-demo
    project: roboshop
spec:
  type: LoadBalancer # <--- capital letters L,B 
  selector:
    purpose: efs-static-demo
    project: roboshop
  ports:
    - protocol: TCP
      port: 80 # service port
      targetPort: 80 # container port 

# ✅ Final Explanation:

# EBS (block storage) = AZ-specific → needs nodeSelector (or topology-aware scheduling) so Pods run where the volume exists.
# EFS (file storage) = Region-wide (multi-AZ) → no need for nodeSelector because any Node can reach it over the network.